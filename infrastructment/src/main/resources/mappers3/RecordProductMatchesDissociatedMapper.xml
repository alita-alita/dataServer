<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.idicc.taotie.infrastructment.mapper.icm.RecordProductMatchesDissociatedMapper">
    <insert id="insertBatch">
        insert ignore into record_product_matches_dissociated(
                                                    chain_id,
                                                    enterprise_id, enterprise_name, enterprise_uni_code,
                                                    product_id, product_name, product_url, product_description, product_purpose,
                                                    label_id, label_name,
                                                    node_id,node_name,
                                                    matched_score, match_reason,status,data_source)
        values
        <foreach collection='list' item='item' separator=','>
        (
             #{item.chainId},
             #{item.enterpriseId},
             #{item.enterpriseName},
             #{item.enterpriseUniCode},
            #{item.productId},
            #{item.productName},
            #{item.productUrl},
            #{item.productDescription},
            #{item.productPurpose},
            #{item.labelId},
             #{item.labelName},
            #{item.nodeId},
            #{item.nodeName},
             #{item.matchedScore},
             #{item.matchReason},
             #{item.status},
             #{item.dataSource}
        )
        </foreach>
    </insert>
    <select id="pageList"
            resultType="cn.idicc.taotie.infrastructment.response.icm.RecordProductMatchesDissociatedDTO">
        select rpmd.*
        from record_product_matches_dissociated rpmd
        where rpmd.chain_id = #{chainId}
        <if test="enterpriseName != null and enterpriseName != ''">
            and rpmd.enterprise_name like concat('%',#{enterpriseName},'%')
        </if>
        <if test="productName != null and productName != ''">
            and rpmd.product_name like concat('%',#{productName},'%')
        </if>
        <if test="status != null">
            and rpmd.status = #{status}
        </if>
        <if test="labelId != null">
            and rpmd.label_id = #{labelId}
        </if>
        <if test="nodeId != null">
            and rpmd.node_id = #{nodeId}
        </if>
        <if test="minMatchedScore != null">
            and rpmd.matched_score >= #{minMatchedScore}
        </if>
    </select>
</mapper>
